const categories = {
      "Basso": {
            phrases: [
                  "Non c'è niente di meglio che un buon match.",
                  "Sono qui per dare il massimo!",
                  "Il wrestling è la mia vita.",
                  "Ogni giorno è una nuova opportunità.",
                  "Non sottovalutate mai il mio impegno.",
                  "Sono pronto per la sfida!",
                  "Il mio cuore batte per questo sport.",
                  "Lavoro duro per arrivare dove sono.",
                  "In ring, ogni mossa conta.",
                  "La passione è ciò che mi guida.",
                  "Voglio ispirare le nuove generazioni.",
                  "Il rispetto è fondamentale in questo sport.",
                  "Il pubblico è la mia motivazione.",
                  "Nessuno può fermarmi quando sono motivato.",
                  "L'unione fa la forza.",
                  "Siamo tutti qui per divertirci.",
                  "Ogni incontro è un'opportunità di crescita.",
                  "La determinazione è la chiave del successo.",
                  "Il wrestling è la mia famiglia.",
                  "Ogni match è una storia da raccontare.",
                  "L'adrenalina è ciò che mi spinge.",
                  "Credo in me stesso e nel mio talento.",
                  "Il ring è il mio palcoscenico.",
                  "Non smetterò mai di combattere.",
                  "La mia carriera è solo all'inizio.",
                  "Ognuno ha il suo viaggio nel wrestling.",
                  "Sono qui per dimostrare il mio valore.",
                  "La disciplina porta ai risultati.",
                  "Il futuro è luminoso per me.",
                  "Il mio viaggio è appena iniziato.",
                  "Ho una missione da compiere.",
                  "Ogni giorno è un passo verso la grandezza.",
                  "La crescita personale è la mia priorità.",
                  "Il mio sogno è più grande di qualsiasi sfida.",
                  "Insieme possiamo raggiungere nuovi traguardi.",
                  "Il sudore di oggi è il successo di domani.",
                  "Non smetto mai di migliorare.",
                  "Ogni mossa è un'opportunità.",
                  "La pazienza è la virtù del campione.",
                  "Credo nella forza del lavoro di squadra.",
                  "Sono qui per scrivere la mia storia.",
                  "Il rispetto reciproco è alla base di questo sport.",
                  "L'impegno porta sempre a risultati.",
                  "Il ring è dove mi sento vivo.",
                  "Voglio essere un modello per gli altri.",
                  "La vittoria è il risultato della perseveranza.",
                  "Ogni avversario è una lezione.",
                  "Il mio viaggio è pieno di sfide, ma non mi fermerò.",
                  "Ogni giorno sono grato di essere qui."
            ],
            score: 1,
      },
      "Medio": {
            phrases: [
                  "Sei solo un imitatore, non un vero lottatore.",
                  "Preparati a essere schiacciato.",
                  "Non ho tempo per i dilettanti.",
                  "Non sei pronto per questo livello.",
                  "La mia abilità ti lascerà senza parole.",
                  "Chi pensi di essere per affrontarmi?",
                  "Sei solo un ostacolo sulla mia strada.",
                  "Non hai idea di cosa stai per affrontare.",
                  "Mi fai ridere con le tue scuse.",
                  "Sei solo un numero nella mia lista.",
                  "La paura è la tua peggior nemica.",
                  "Il mio stile di lotta è unico.",
                  "Ti mostrerò cosa significa essere battuto.",
                  "Nessuno è al sicuro quando sono in giro.",
                  "Ogni colpo che prendi è una lezione.",
                  "Non hai idea di quanto possa essere brutale.",
                  "Preparati a essere messo a tacere.",
                  "Il tuo tempo è scaduto.",
                  "Ti porterò a un altro livello di dolore.",
                  "Non puoi ignorare il mio talento.",
                  "La mia vendetta sarà dolce.",
                  "Ogni match è una battaglia e io vinco sempre.",
                  "Il tuo fallimento è solo questione di tempo.",
                  "Prepara i tuoi scusanti per la sconfitta.",
                  "Sei solo un wannabe nel mondo del wrestling.",
                  "Il tuo nome sarà dimenticato, mentre il mio vivrà per sempre.",
                  "Ti porterò via tutto ciò che ami.",
                  "Nessuno piangerà la tua sconfitta.",
                  "Sei pronto a perdere?",
                  "Fai attenzione, perché io sono qui per vincere.",
                  "Ti farò capire chi comanda.",
                  "Preparati a una lezione che non dimenticherai.",
                  "Non meriti nemmeno il tempo di un vero campione.",
                  "La mia forza è inarrestabile.",
                  "Ogni mossa che fai è un errore.",
                  "La tua paura è il mio carburante.",
                  "Sei destinato a essere dimenticato.",
                  "Prepara il tuo addio.",
                  "La mia determinazione è superiore alla tua.",
                  "I miei avversari diventano solo statistiche.",
                  "Sei solo un'ombra del vero campione.",
                  "Ogni tua scusa è un motivo di gioia per me.",
                  "Non puoi competere con il mio talento.",
                  "La tua resa è inevitabile.",
                  "Non puoi fermare ciò che è destinato a vincere.",
                  "I tuoi sogni finiranno in questo ring.",
                  "Non c'è posto per i deboli qui.",
                  "Il tuo ritiro è l'unica opzione."
            ],
            score: 2,
      },
      "Alto": {
            phrases: [
                  "Sei un perdente, e lo sai!",
                  "Non sei nemmeno degno di essere nel mio stesso ring.",
                  "Il tuo ego è più grande della tua abilità.",
                  "Non ho pietà per chi non merita rispetto.",
                  "Il tuo tempo è finito, rientra nella mediocrità.",
                  "Ti distruggerò e non ci sarà niente che puoi fare.",
                  "Sei così debole che potrei batterti con una mano sola.",
                  "Hai mai vinto qualcosa di significativo?",
                  "La tua carriera è una barzelletta.",
                  "Ogni volta che entri in ring, fai ridere tutti.",
                  "Sarai ricordato come il grande sconfitto.",
                  "Non sei in grado di sopportare il mio potere.",
                  "Il tuo faccia non dovrebbe nemmeno essere nel mio ring.",
                  "Ho più talento nel mignolo che tu in tutto il corpo.",
                  "La verità fa male e io sono qui per dirla.",
                  "Non meriti nemmeno il mio tempo.",
                  "Il tuo fallimento sarà la mia vittoria.",
                  "Non ci sono regole quando combatti con me.",
                  "Sei solo un brutto ricordo.",
                  "Non c'è scampo dalla mia ira.",
                  "Prepara i tuoi amici a piangere la tua sconfitta.",
                  "La tua fine è imminente.",
                  "Non sarai mai alla mia altezza.",
                  "Ti mostrerò cosa significa il vero dolore.",
                  "Sei destinato a fallire.",
                  "La tua carriera finisce qui.",
                  "Prepara i tuoi bagagli, perché stai per perdere tutto.",
                  "Non c'è scampo per te.",
                  "Ti porterò a piangere come un bambino.",
                  "Non sei altro che un campione di scuse.",
                  "Il tuo destino è segnato.",
                  "Preparati a essere annientato.",
                  "Non ci sarà pietà per i deboli.",
                  "La tua sconfitta sarà epica.",
                  "Sei un mero imitatore.",
                  "Sarai il mio trofeo più facile.",
                  "Non c'è via d'uscita per te.",
                  "La tua arroganza ti porterà alla rovina.",
                  "Il ring è dove i deboli vengono messi a tacere.",
                  "Sei già sconfitto prima di iniziare.",
                  "Ogni parola che dici è un'illusione.",
                  "Ti distruggerò senza pietà.",
                  "Non hai idea di cosa sto per farti.",
                  "Il tuo nome non sarà ricordato.",
                  "Sei già finito."
            ],
            score: 3,
      }
};

let wrestler1Score = 0;
let wrestler2Score = 0;

// Funzione per generare frasi casuali per ogni categoria
function generateRandomPhrases() {
      const randomChoices = [];

      for (const category in categories) {
            const phrases = categories[category].phrases;

            if (phrases && phrases.length > 0) {
                  const randomIndex = Math.floor(Math.random() * phrases.length);
                  randomChoices.push(phrases[randomIndex]);
            } else {
                  console.warn(`Nessuna frase trovata per la categoria: ${category}`);
            }
      }

      return randomChoices;
}

// Funzione per mescolare l'ordine delle frasi sui bottoni
function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
      }
}

// Visualizza le frasi nel DOM
function displayPhrases() {
      let randomChoices = generateRandomPhrases();
      shuffle(randomChoices); // Mescola l'ordine delle frasi

      randomChoices.forEach((phrase, index) => {
            document.getElementById(`choice${index + 1}`).innerText = phrase;
      });
}

// Gestisce la risposta dell'utente e aggiorna i punteggi
function handleResponse(choice) {
      displayPhrases();
      const userPhrase = document.getElementById(`choice${choice}`).innerText;
      let userScorePromo = getPhraseScore(userPhrase);

      wrestler1Score += userScorePromo;

      const cpuChoice = generateCpuPhrase();
      const cpuScorePromo = getPhraseScore(cpuChoice);

      wrestler2Score += cpuScorePromo;

      const scoreDisplay = document.getElementById('scoreDisplay');
      scoreDisplay.textContent = `Punteggio Promo: ${playerCharacter}: ${wrestler1Score}, ${cpuCharacter}: ${wrestler2Score}`;

      updateBattleGround(playerCharacter, userPhrase, cpuCharacter, cpuChoice);
      checkForWinner();
}

// Funzione per selezionare una frase casuale della CPU
function generateCpuPhrase() {
      const allPhrases = Object.values(categories).flatMap(category => category.phrases);
      const randomIndex = Math.floor(Math.random() * allPhrases.length);
      return allPhrases[randomIndex];
}

// Funzione per ottenere il punteggio di una frase
function getPhraseScore(phrase) {
      for (const category of Object.values(categories)) {
            if (category.phrases.includes(phrase)) {
                  return category.score;
            }
      }
      return 0;
}

// Aggiorna il campo di battaglia con le frasi
function updateBattleGround(playerCharacter, userPhrase, cpuCharacter, cpuResponse) {
      const battleElement = document.getElementById("promoBattle");
      battleElement.innerHTML += `<p><strong>${playerCharacter}:</strong> ${userPhrase}</p>`;
      battleElement.innerHTML += `<p><strong>${cpuCharacter}:</strong> ${cpuResponse}</p>`;
      scrollToBottom("promoBattle");
}

// Verifica se c’è un vincitore
function checkForWinner() {
      if (wrestler1Score >= 15 || wrestler2Score >= 15) {
            const winner = wrestler1Score >= 15 ? playerCharacter : cpuCharacter;
            alert(`${winner} ha vinto il promo!`);

            // Mostra il pulsante "Continua"
            continuaButton.style.display = 'block'; // Mostra il pulsante

            aggiornaPunteggi(winner);

            disableChoices(); // Disabilita le scelte quando c'è un vincitore
            resetGame();
      }
}

function scrollToBottom(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
            element.scrollTop = element.scrollHeight;
      }
}

function aggiornaPunteggi(winner) {
      if (winner) {
            if (winner === playerCharacter) {
                  playerScore += 10;
            } else {
                  cpuScore += 10;
            }
      }
      salvaDati();

      turnMessage.innerHTML = `Punteggio: ${playerCharacter}: ${playerScore}, ${cpuCharacter}: ${cpuScore}`;
}

// Resetta i punteggi e aggiorna l'interfaccia
function resetGame() {
      wrestler1Score = 0;
      wrestler2Score = 0;
      displayPhrases();
}

// Inizializza il gioco
function promoBattle() {
      wrestler1Score = 0;
      wrestler2Score = 0;
      displayPhrases(); // Visualizza le frasi iniziali

      // Salva lo storico nel localStorage
      localStorage.setItem('turnHistory', JSON.stringify(turnHistory));
      localStorage.setItem('totalMatches', totalMatches);
      localStorage.setItem('currentTurn', currentTurn);
      localStorage.setItem('playerScore', playerScore);
      localStorage.setItem('cpuScore', cpuScore);
      localStorage.setItem('playerGamePoints', playerGamePoints);
      localStorage.setItem('cpuGamePoints', cpuGamePoints);
}


function disableChoices() {
      for (let i = 1; i <= 3; i++) {
            const choiceElement = document.getElementById(`choice${i}`);
            if (choiceElement) {
                  choiceElement.style.pointerEvents = 'none'; // Disabilita gli eventi di puntamento
                  choiceElement.style.opacity = '0.5'; // Rendi visivamente non selezionabile
            }
      }
}

promoBattle();